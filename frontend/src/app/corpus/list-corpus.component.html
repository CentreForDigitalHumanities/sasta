<ng-container *ngIf="corpora$ | async as corpora; else loading">
    <p-table [value]="corpora" [rowHover]="true" sortField="date_added" [sortOrder]="-1">
        <ng-template pTemplate="header">
            <tr>
                <th pSortableColumn="name">Name <p-sortIcon field="name" /></th>
                <th pSortableColumn="num_transcripts">
                    Transcripts (#) <p-sortIcon field="num_transcripts" />
                </th>
                <th
                    pSortableColumn="username"
                    *ngIf="(authService.currentUser$ | async).isAdmin"
                >
                    Owner <p-sortIcon field="username" />
                </th>
                <th pSortableColumn="date_added">Created on<p-sortIcon field="date_added" /></th>
                <th class="has-text-right">Actions</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-corpus>
            <tr [routerLink]="['/corpora/', corpus.id]">
                <td>{{ corpus.name }}</td>
                <td>{{ corpus.num_transcripts || "0" }}</td>
                <td *ngIf="(authService.currentUser$ | async).isAdmin">
                    {{ corpus.username }}
                </td>
                <td>{{ corpus.date_added | date: "dd/MM/yyyy" }}</td>
                <td class="has-text-right">
                    <div class="buttons is-right">
                        <button class="button is-success" pTooltip="add transcripts" (click)="$event.stopPropagation()"
                            [routerLink]="['/upload']" [queryParams]="{ corpus: corpus.id }">
                            <span class="icon is-small">
                                <fa-icon [icon]="faPlus"></fa-icon>
                            </span>
                        </button>
                        <button class="button is-danger" pTooltip="delete corpus"
                            (click)="confirmDeleteCorpus($event, corpus)">
                            <span class="icon is-small">
                                <fa-icon [icon]="faTrash"></fa-icon>
                            </span>
                        </button>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>

    <h1 *ngIf="corpora.length === 0" class="title is-2">
        No corpora yet!
        <a [routerLink]="['/upload']" routerLinkActive="is-active"> Upload </a>
    </h1>

    <p-confirmDialog [dismissableMask]="true"></p-confirmDialog>
</ng-container>
<ng-template #loading>
    <div>
        <progress class="progress is-small is-primary" max="100"></progress>
    </div>
</ng-template>
